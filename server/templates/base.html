<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Federated Learning Network - {% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='fontawesome/all.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript">
    // Load the Visualization API and the piechart package.
    google.charts.load('current', {'packages':['corechart']});    
    // Set a callback to run when the Google Visualization API is loaded.
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {}
    </script>
    <script>
        window.onload = function() {
          $.ajax({
            url: "getData_Irradiation.php",
            dataType: "json",
            success: function (jsonData) {
                var data = new google.visualization.DataTable();
                data.addColumn('number', 'id');
                data.addColumn('number', 'irradiation');
            var j = 0;
                for (var i = 0; i < jsonData.length; i++) {
                    data.addRow(
            [
            i, 
            parseFloat(jsonData[i].irradiation)
            ]);
            j++;
                }
            for (var i = 0; i< jsonData.length/4; i++){
              data.addRow(
            [
            j, 
            null
            ]);
            j++;
            }
            
            data.addRow(
            [
            j, 
            0
            ]);
    
                var options = {
              title: 'Irradiation',
              //width: 500,
              //height: 300,
              //curveType: 'function',
              vAxis: {
                  title: 'kW/m^2',
                  viewWindow: {
                  min: 0,
                  max: 1500
                  },
              },
              hAxis: { textPosition: 'none' },
                  
              legend: { position: 'bottom' }
          };
          
                var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));
                chart.draw(data, options);
            }
        
        
        });
        
        $.ajax({
            url: "getData_Temperature.php",
            dataType: "json",
            success: function (jsonData_temp) {
                var data_temp = new google.visualization.DataTable();
                data_temp.addColumn('number', 'id');
                data_temp.addColumn('number', 'temperature');
            
            var j = 0;
                for (var i = 0; i < jsonData_temp.length; i++) {
                    data_temp.addRow([i,
            //parseFloat(jsonData_temp[i].id), 
            parseFloat(jsonData_temp[i].temperature)]);
            j++;
                }
            
            for (var i = 0; i< jsonData_temp.length/4; i++){
              data_temp.addRow([j, null]);
              j++;}
            
            data_temp.addRow([j, 0]);
                var options = {
              title: 'Temperature',
              //width: 500,
              //height: 300,
              //curveType: 'function',
              vAxis: {
                  title: 'C',
                  viewWindow: {
                  min: -100,
                  max: 100
                  },
              },
              hAxis: { textPosition: 'none' },
                  
              legend: { position: 'bottom' },
              
              series: {
                  0: { color: '#e2431e' }
              }
          };
          
                var chart_temp = new google.visualization.LineChart(document.getElementById('temperature'));
                chart_temp.draw(data_temp, options);
            }
        
        
        });
        
          
        setInterval(function(){updateChart()}, 2000);
        
        function updateChart() {
          
          $.ajax({
            url: "getData_Irradiation.php",
            dataType: "json",
            success: function (jsonData) {
                var data = new google.visualization.DataTable();
                data.addColumn('number', 'id');
                data.addColumn('number', 'irradiation');
            
            
            var j = 0;
                for (var i = 0; i < jsonData.length; i++) {
                    data.addRow(
            [
            i,
            //parseFloat(jsonData[i].id), 
            parseFloat(jsonData[i].irradiation)
            ]);
            j++;
                }
            
            for (var i = 0; i< jsonData.length/4; i++){
              data.addRow([j, null]);
            j++;}
            data.addRow([j, 0]);
            var options = {
              title: 'Irradiation',
              //width: 500,
              //height: 300,
              //curveType: 'function',
              vAxis: {
                  title: 'kW/m^2',
                  viewWindow: {
                  min: 0,
                  max: 1500
                  },
              },
              hAxis: { textPosition: 'none' },
              legend: { position: 'bottom' }};
                var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));
                chart.draw(data, options); 
        }
        });
        
        $.ajax({
            url: "getData_Temperature.php",
            dataType: "json",
            success: function (jsonData_temp) {
                var data_temp = new google.visualization.DataTable();
                data_temp.addColumn('number', 'id');
                data_temp.addColumn('number', 'temperature');
            
            var j = 0;
    
            for (var i = 0; i < jsonData_temp.length; i++) {
                data_temp.addRow([i,
                //parseFloat(jsonData_temp[i].id), 
                parseFloat(jsonData_temp[i].temperature)
            ]);

            j++;}
            
            for (var i = 0; i< jsonData_temp.length/4; i++){
            data_temp.addRow([j, null]);j++;}
            data_temp.addRow([j, 0]);
    
            var options = {
            title: 'Temperature',
              //width: 500,
              //height: 300,
              //curveType: 'function',
            vAxis: {title: 'C',viewWindow: {min: -100, max: 100},
            },
            hAxis: { textPosition: 'none' },
            legend: { position: 'bottom' },
            series: {0: { color: '#e2431e'}}
          };
          
            var chart_temp = new google.visualization.LineChart(document.getElementById('temperature'));
            chart_temp.draw(data_temp, options);
            }
        
        
        });
      }
    }
    
        </script>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <span class="navbar-brand mb-0 h1">Federated Learning Network</span>
    </nav>
    <div class="container-fluid">
        <section class="content">
            {% block content %}{% endblock %}
        </section>
    </div>
    <div id="curve_chart"></div>
    <!--Div that will hold the temperature chart-->
    <div id="temperature"></div>

<script src="{{ url_for('static', filename='jquery/jquery-3.5.1.slim.min.js') }}"></script>
<script src="{{ url_for('static', filename='bootstrap/bootstrap.bundle.min.js') }}"></script>
<script src="{{ url_for('static', filename='fontawesome/all.min.js') }}"></script>
{% block javascript %}{% endblock %}
</body>
